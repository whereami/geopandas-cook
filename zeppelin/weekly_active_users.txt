%spark
import java.text._
import java.util._
import Calendar._

val dateFormat = new SimpleDateFormat("yyyy-MM-dd")
val cal = Calendar.getInstance()

var from_date = z.input("시작 날짜")
var until_date = z.input("종료 날짜")

var sql = "select weekofyear(from_time) summary_week, count(distinct kiwi_child_id) kiwi_child_count from kiwi.kiwi_child_location_log "
sql += "where to_date(concat(year, '-', month, '-', day)) between '" + from_date + "' and '" + until_date + "' "
sql += "group by weekofyear(from_time) order by weekofyear(from_time) "

println(sql)

z.show(sqlContext.sql(sql))